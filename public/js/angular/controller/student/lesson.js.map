{"version":3,"sources":["lesson.coffee"],"names":[],"mappings":"AAAA;EAAA;EAEA,MAAM,CAAC,KAAK,CAAC,UAAb,CAAwB,QAAxB,EAAkC;IACjC,QADiC,EAEjC,OAFiC,EAGjC,SAAC,EAAD,EAAK,KAAL;AACC,UAAA;MAAA,IAAA,GAAO;;AAEP;MACA,EAAE,CAAC,IAAH,GAAU,SAAA;QACT,OAAO,CAAC,IAAR,CAAa,SAAC,IAAD;;AACZ;UACA,OAAO,CAAC,gBAAR,CAAyB,SAAA;;AACxB;YACA,WAAW,CAAC,IAAZ,CAAA;;AACA;YACA,YAAY,CAAC,IAAb,CAAA;;AACA;YACA,WAAW,CAAC,aAAZ,CAAA;;AACA;UAPwB,CAAzB,EASE,SAAA;YACD,OAAO,CAAC,GAAR,CAAY,sBAAZ;UADC,CATF;QAFY,CAAb,EAeE,SAAC,KAAD,EAAQ,IAAR;UACD,OAAO,CAAC,IAAR,CAAa,2BAAb,EAA0C,KAA1C,EAAiD,IAAjD;QADC,CAfF;MADS;;AAoBV;;;;MAIA,EAAE,CAAC,gBAAH,GAAsB,SAAC,IAAD;AACrB,YAAA;QAAA,OAAO,CAAC,IAAR,CAAa,IAAb;;AAEA;QACA,OAAA,GAAa,OAAO,IAAI,CAAC,OAAZ,KAAuB,WAA1B,GAA2C,IAAI,CAAC,OAAhD,GAA6D;;AAEvE;AACA,gBAAO,OAAP;AAAA,eACM,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,MADlC;;AAEE;YACA,OAAO,CAAC,IAAR,CAAa,2CAAb;YACA,MAAM,CAAC,QAAQ,CAAC,IAAhB,GAAuB,mBAAA,GAAsB,OAAO,CAAC,MAAM,CAAC,SAArC,GAAiD;AACxE;AALF,eAMM,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,MANlC;;AAOE;YACA,OAAO,CAAC,IAAR,CAAa,uCAAb;AACA;AATF,eAUM,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,OAVlC;;AAWE;YACA,OAAO,CAAC,GAAR,CAAY,6HAAZ;AACA;;AACA;YACA,UAAA,CAAW,SAAA;cACV,MAAM,CAAC,QAAQ,CAAC,IAAhB,GAAuB,kBAAA,GAAqB;YADlC,CAAX,EAGE,IAHF;AAIA;AAnBF;YAqBE,OAAO,CAAC,GAAR,CAAY,4CAAZ,EAA0D,OAA1D;AArBF;MAPqB;IA5BvB,CAHiC;GAAlC;AAFA","file":"lesson.js","sourcesContent":["'use strict'\n\nwindow.ncApp.controller 'Lesson', [\n\t'$scope'\n\t'$http'\n\t($s, $http) ->\n\t\tself = this\n\t\t\n\t\t### initialize lesson ###\n\t\t$s.init = () ->\n\t\t\tconnect.init (conn) ->\n\t\t\t\t### initialize camera ###\n\t\t\t\tconnect.initializeCamera ->\n\t\t\t\t\t### initialize events ###\n\t\t\t\t\teventCommon.init()\n\t\t\t\t\t### initialize student events ###\n\t\t\t\t\teventStudent.init()\n\t\t\t\t\t### initialize connect to room ###\n\t\t\t\t\teventCommon.connectToRoom()\n\t\t\t\t\t### catch when no camera is detected ###\n\t\t\t\t\treturn\n\t\t\t\t, ->\n\t\t\t\t\tconsole.log 'Cannot detect camera'\n\t\t\t\t\treturn\n\t\t\t\treturn\n\t\t\t, (error, conn) ->\n\t\t\t\tconsole.warn 'ERROR to connect socket: ', error, conn\n\t\t\t\treturn\n\t\t\treturn\n\t\t###*\n\t\t * disconnecting lesson\n\t\t * @param  {Object} data  contains information about the disconnection\n\t\t###\n\t\t$s.lessonDisconnect = (data) ->\n\t\t\tconsole.warn data\n\t\t\t\n\t\t\t### prepare command ###\n\t\t\tcommand = if typeof data.command != 'undefined' then data.command else 'unknown'\n\t\t\t\n\t\t\t### process the disconnection ###\n\t\t\tswitch command\n\t\t\t\twhen constant.disconnect.teacher.others\n\t\t\t\t\t### teacher has suddenly stop the lesosn by others ###\n\t\t\t\t\tconsole.warn '[SOCKET] teacher stopped lesson by others'\n\t\t\t\t\twindow.location.href = '/student/teacher/' + connect.config.teacherID + \"?action=lessonEnd\"\n\t\t\t\t\tbreak\n\t\t\t\twhen constant.disconnect.teacher.sudden\n\t\t\t\t\t### student will be notify by theacher's sudden disconnection ###\n\t\t\t\t\tconsole.warn '[SOCKET] teacher sudden disconnection'\n\t\t\t\t\tbreak\n\t\t\t\twhen constant.disconnect.teacher.timeOut\n\t\t\t\t\t### teacher's connection to the socket server timed out ###\n\t\t\t\t\tconsole.log '[SOCKET] Because the teacher was unable to reconnect within the alotted time, the system will automatically end the lesson.'\n\t\t\t\t\tbreak\n\t\t\t\t\t### redirect student to dashboard ###\n\t\t\t\t\tsetTimeout () ->\n\t\t\t\t\t\twindow.location.href = '/student?action=' + command\n\t\t\t\t\t\treturn\n\t\t\t\t\t, 2000\n\t\t\t\t\tbreak\n\t\t\t\telse\n\t\t\t\t\tconsole.log '[SOCKET] Unknown disconnection command -> ', command\n\t\t\treturn\n\t\treturn\n]"],"sourceRoot":"/source/"}