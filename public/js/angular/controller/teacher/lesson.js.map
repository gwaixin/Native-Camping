{"version":3,"sources":["lesson.coffee"],"names":[],"mappings":"AAAA;EAAA;EAEA,MAAM,CAAC,KAAK,CAAC,UAAb,CAAwB,QAAxB,EAAkC;IACjC,QADiC,EAEjC,OAFiC,EAGjC,SAAC,EAAD,EAAK,KAAL;AACC,UAAA;MAAA,IAAA,GAAO;;AAEP;MACA,EAAE,CAAC,IAAH,GAAU,SAAA;eACT,OAAO,CAAC,IAAR,CAAa,SAAC,IAAD;;AACZ;iBACA,OAAO,CAAC,iBAAR,CAA0B,SAAA;;AACzB;YACA,WAAW,CAAC,IAAZ,CAAA;;AACA;YACA,YAAY,CAAC,IAAb,CAAA;;AACA;YACA,WAAW,CAAC,aAAZ,CAAA;;AACA;UAPyB,CAA1B,EASE,SAAA;YACD,OAAO,CAAC,GAAR,CAAY,sBAAZ;UADC,CATF;QAFY,CAAb,EAcE,SAAC,KAAD,EAAQ,IAAR;iBACD,OAAO,CAAC,IAAR,CAAa,0BAAb,EAAyC,KAAzC,EAAgD,IAAhD;QADC,CAdF;MADS;;AAkBV;;;;MAIA,EAAE,CAAC,gBAAH,GAAsB,SAAC,IAAD;AACrB,YAAA;QAAA,OAAO,CAAC,IAAR,CAAa,IAAb;;AAEA;QACA,OAAA,GAAa,OAAO,IAAI,CAAC,OAAZ,KAAuB,WAA1B,GAA2C,IAAI,CAAC,OAAhD,GAA6D;;AAEvE;AACA,gBAAO,OAAP;AAAA,eACM,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,OADlC;;AAEE;YACA,OAAO,CAAC,GAAR,CAAY,oHAAZ;;AAEA;YACA,UAAA,CAAW,SAAA;cACV,MAAM,CAAC,QAAQ,CAAC,IAAhB,GAAuB,kBAAA,GAAqB;YADlC,CAAX,EAGE,IAHF;AALI;AADN;;AAYE;YACA,OAAO,CAAC,GAAR,CAAY,mCAAZ,EAAiD,OAAjD;AACA;AAdF;MAPqB;;AAwBtB;;;MAGA,EAAE,CAAC,QAAH,GAAc,SAAA;AACb,YAAA;QAAA,OAAO,CAAC,IAAR,CAAa,mBAAb;QACA,MAAA,GAAS,MAAA,CAAO,sDAAP,EAA+D,aAA/D;QAET,IAAG,MAAH;UACC,IAAA,GAAO;YACN,OAAA,EAAS,+BADH;YAEN,OAAA,EAAS,OAAO,CAAC,MAFX;YAGN,IAAA,EAAM,IAHA;;UAKP,WAAW,CAAC,WAAZ,CAAwB,IAAxB;iBACA,MAAM,CAAC,QAAQ,CAAC,IAAhB,GAAuB,wBAPxB;SAAA,MAAA;AAAA;;MAJa;IArDf,CAHiC;GAAlC;AAFA","file":"lesson.js","sourcesContent":["'use strict'\n\nwindow.ncApp.controller 'Lesson', [\n\t'$scope'\n\t'$http'\n\t($s, $http) ->\n\t\tself = this\n\t\t\n\t\t### initialize lesson ###\n\t\t$s.init = () ->\n\t\t\tconnect.init (conn) ->\n\t\t\t\t###initialize camera ###\n\t\t\t\tconnect.intitializeCamera ->\n\t\t\t\t\t### initialize events ###\n\t\t\t\t\teventCommon.init()\n\t\t\t\t\t### initialize events ###\n\t\t\t\t\teventTeacher.init()\n\t\t\t\t\t### initialize connect to room ###\n\t\t\t\t\teventCommon.connectToRoom()\n\t\t\t\t\t### catch when no camera is detected ###\n\t\t\t\t\treturn\n\t\t\t\t, ->\n\t\t\t\t\tconsole.log 'Cannot detect camera'\n\t\t\t\t\treturn\n\t\t\t, (error, conn) ->\n\t\t\t\tconsole.warn 'ERROR to connect socket:', error, conn\n\t\t\n\t\t###*\n\t\t * disconnecting lesson\n\t\t * @param  {Object} data contains information about the disconnection\n\t\t###\n\t\t$s.lessonDisconnect = (data) ->\n\t\t\tconsole.warn data\n\t\t\t\n\t\t\t### prepare command ###\n\t\t\tcommand = if typeof data.command != 'undefined' then data.command else 'unknown'\n\t\t\t\n\t\t\t### check the disconnection type ###\n\t\t\tswitch command\n\t\t\t\twhen constant.disconnect.student.timeOut \n\t\t\t\t\t### student's connection to the socket server timed out ###\n\t\t\t\t\tconsole.log 'Because the student was unable to reconnect within the alotted time, the system will automatically end the lesson.'\n\t\t\t\t\t\n\t\t\t\t\t### redirect the teacher to dashboard ###\n\t\t\t\t\tsetTimeout(() ->\n\t\t\t\t\t\twindow.location.href = '/teacher?action=' + command\n\t\t\t\t\t\treturn\n\t\t\t\t\t, 2000)\n\t\t\t\t\t\n\t\t\t\telse \n\t\t\t\t\t### command does not belongs to any case ###\n\t\t\t\t\tconsole.log 'Unknown disconnection command -> ', command\n\t\t\t\t\tbreak\n\t\t\treturn\n\t\t\n\t\t###*\n\t\t * redirect to others page, however it will stop the lesson if it has lesson\n\t\t###\n\t\t$s.toOthers = () ->\n\t\t\tconsole.warn '[NG] go to others'\n\t\t\treason = prompt \"Are you sure to go to others? state your reason why.\", \"reason here\"\n\n\t\t\tif reason\n\t\t\t\tdata = {\n\t\t\t\t\tcommand: 'teacherLessonDisconnectOthers',\n\t\t\t\t\tcontent: connect.config,\n\t\t\t\t\tmode: 'to'\n\t\t\t\t}\n\t\t\t\teventCommon.sendCommand data\n\t\t\t\twindow.location.href = \"/teacher?action=other\"\n\t\t\telse\n\t\t\t\treturn\n\n\t\treturn\n\t\t\t\t\n]"],"sourceRoot":"/source/"}